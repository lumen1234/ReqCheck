import{a as I}from"./api-B5B5DeYR.js";import{_ as V,c as m,a as s,w as o,b as t,e as x,d as l,t as a,f as g,F as k,g as b,r as p,o as d}from"./index-ahAVBiDV.js";const q={name:"DocumentDetail",data(){return{docId:"",document:null,requirementTrees:[],validationResults:[],loading:!1,treeProps:{children:"children",label:"name"}}},mounted(){this.docId=this.$route.params.docId,this.getDocumentDetail()},methods:{async getDocumentDetail(){this.loading=!0;try{const r=await I(this.docId);this.document=r.data.document,this.requirementTrees=r.data.requirement_trees,this.validationResults=r.data.validation_results}catch{this.$message.error("获取文档详情失败")}finally{this.loading=!1}},formatDate(r){return r?new Date(r).toLocaleString():""},getStatusType(r){switch(r){case"已上传":return"info";case"已解析":return"success";default:return"default"}},goToParse(){this.$router.push(`/parse/${this.docId}`)},goToValidate(){this.$router.push(`/validate/${this.docId}`)},goToExport(){this.$router.push(`/export/${this.docId}`)},goToHistory(){this.$router.push("/history")}}},B={class:"document-detail"},N={class:"card-header"},P={class:"card-body"},R={style:{display:"grid","grid-template-columns":"repeat(2, 1fr)",gap:"10px"}},E={class:"custom-tree-node"},H={key:0,class:"original-text"},S={style:{"margin-top":"20px"}};function j(r,e,F,L,n,i){const c=p("el-button"),v=p("el-tag"),D=p("el-alert"),T=p("el-tree"),f=p("el-card"),_=p("el-table-column"),C=p("el-table");return d(),m("div",B,[s(f,{shadow:"hover",style:{"max-width":"1000px",margin:"0 auto"}},{header:o(()=>[t("div",N,[e[1]||(e[1]=t("span",null,"文档详情",-1)),s(c,{onClick:i.goToHistory},{default:o(()=>[...e[0]||(e[0]=[l("返回历史列表",-1)])]),_:1},8,["onClick"])])]),default:o(()=>[t("div",P,[n.document?(d(),x(D,{key:0,title:"文档信息",type:"info","show-icon":"",closable:!1,style:{"margin-bottom":"20px"}},{default:o(()=>[t("div",R,[t("p",null,[e[2]||(e[2]=t("strong",null,"文档ID:",-1)),l(" "+a(n.document.id),1)]),t("p",null,[e[3]||(e[3]=t("strong",null,"文件名:",-1)),l(" "+a(n.document.filename),1)]),t("p",null,[e[4]||(e[4]=t("strong",null,"文档类型:",-1)),l(" "+a(n.document.file_type),1)]),t("p",null,[e[5]||(e[5]=t("strong",null,"上传时间:",-1)),l(" "+a(i.formatDate(n.document.upload_time)),1)]),t("p",null,[e[6]||(e[6]=t("strong",null,"状态:",-1)),e[7]||(e[7]=l()),s(v,{type:i.getStatusType(n.document.status)},{default:o(()=>[l(a(n.document.status),1)]),_:1},8,["type"])])])]),_:1})):g("",!0),n.requirementTrees.length>0?(d(),x(f,{key:1,shadow:"hover",style:{"margin-bottom":"20px"}},{header:o(()=>[...e[8]||(e[8]=[t("div",{class:"sub-card-header"},[t("span",null,"需求树结构")],-1)])]),default:o(()=>[(d(!0),m(k,null,b(n.requirementTrees,(u,w)=>(d(),m("div",{key:u.id,style:{"margin-bottom":"20px"}},[t("p",null,[e[9]||(e[9]=t("strong",null,"解析时间:",-1)),l(" "+a(i.formatDate(u.parse_time)),1)]),s(T,{data:u.tree_json.children,props:n.treeProps,"node-key":"id","default-expand-all":"",style:{"margin-top":"10px"}},{default:o(({node:y,data:h})=>[t("span",E,[t("span",null,a(h.name),1),h.original_text?(d(),m("span",H,a(h.original_text),1)):g("",!0)])]),_:1},8,["data","props"])]))),128))]),_:1})):g("",!0),n.validationResults.length>0?(d(),x(f,{key:2,shadow:"hover"},{header:o(()=>[...e[10]||(e[10]=[t("div",{class:"sub-card-header"},[t("span",null,"验证结果")],-1)])]),default:o(()=>[(d(!0),m(k,null,b(n.validationResults,(u,w)=>(d(),m("div",{key:u.id,style:{"margin-bottom":"20px"}},[t("p",null,[e[11]||(e[11]=t("strong",null,"验证时间:",-1)),l(" "+a(i.formatDate(u.validate_time)),1)]),s(C,{data:u.result_json,style:{width:"100%","margin-top":"10px"}},{default:o(()=>[s(_,{prop:"name",label:"需求名称",width:"200"}),s(_,{prop:"result",label:"验证结果",width:"100"},{default:o(({row:y})=>[s(v,{type:y.result?"success":"danger"},{default:o(()=>[l(a(y.result?"合规":"不合规"),1)]),_:2},1032,["type"])]),_:2},1024),s(_,{prop:"reason",label:"验证依据"})]),_:2},1032,["data"])]))),128))]),_:1})):g("",!0),t("div",S,[s(c,{type:"primary",onClick:i.goToParse},{default:o(()=>[...e[12]||(e[12]=[l("解析文档",-1)])]),_:1},8,["onClick"]),s(c,{type:"success",onClick:i.goToValidate},{default:o(()=>[...e[13]||(e[13]=[l("验证需求",-1)])]),_:1},8,["onClick"]),s(c,{type:"info",onClick:i.goToExport},{default:o(()=>[...e[14]||(e[14]=[l("导出需求",-1)])]),_:1},8,["onClick"]),s(c,{onClick:i.goToHistory},{default:o(()=>[...e[15]||(e[15]=[l("返回历史",-1)])]),_:1},8,["onClick"])])])]),_:1})])}const G=V(q,[["render",j],["__scopeId","data-v-7e196259"]]);export{G as default};
